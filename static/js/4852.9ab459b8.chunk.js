"use strict";(self.webpackChunksofia_frontend=self.webpackChunksofia_frontend||[]).push([[4852],{4852:(e,l,t)=>{t.r(l),t.d(l,{default:()=>D});var i=t(72791),n=t(60364),o=t(67571),a=t(79684),r=t(29124),s=t(91356),d=t(98775),c=t(96052),u=t(37702),v=t(29557),p=t(86968),h=(t(45185),t(62249)),m=t(36279),g=t(81694),j=t.n(g),f=t(42506),x=t(72428),b=t(66426),y=t(82068),_=t(22835),N=t(410),S=t(80184);const O=[{label:"Captura",value:0},{label:"Seguimiento",value:1},{label:"Registrada",value:2}],w=[["Vivienda Nueva","Vivienda Usada"],"L\xednea 3"],k=e=>{let{delegations:{can:l,requests:t,totalPage:i,dropdownOpen:n,handleEditBtn:o,getLabelToShow:r,toggleDropdown:s,handleDeleteBtn:d,togglePaginator:u,addressFormatter:v,handleChangeStatus:p,handleShowRequestDetails:h}}=e;return(0,S.jsxs)("div",{id:"RequestTable",children:[(0,S.jsxs)(c.iA,{responsive:!0,hover:!0,children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"title",children:"Clave"}),(0,S.jsx)("th",{className:"title",children:"valuador"}),(0,S.jsx)("th",{className:"title",children:"controlador"}),(0,S.jsx)("th",{className:"title",children:"tipo solicitud"}),(0,S.jsx)("th",{className:"title",children:"solicitante"}),(0,S.jsx)("th",{className:"title",children:"propietario"}),(0,S.jsx)("th",{className:"title",children:"domicilio"}),(0,S.jsx)("th",{className:"title",children:"estado"}),(0,S.jsx)("th",{className:"title",children:"status"}),(0,S.jsx)("th",{className:"title",children:"Fecha"}),(0,S.jsx)("th",{className:"title last-column",children:"Acciones"})]})}),(0,S.jsx)("tbody",{children:(0,a.qt)(t)&&t.map((e=>{var t,i,u,m,g,y,k,C,q,P,z,E,Z,L,R,T;return(0,S.jsxs)("tr",{id:"tooltip-".concat(null===e||void 0===e?void 0:e._id),className:(null===e||void 0===e?void 0:e.subject)&&"table-danger",onClick:h(null===e||void 0===e?void 0:e._id),children:[(0,S.jsx)("td",{children:null===e||void 0===e?void 0:e.key}),(0,S.jsx)("td",{children:(0,S.jsxs)("div",{className:"group",children:[(0,S.jsx)(_.Z,{rounded:!0,size:21,image:null!==(t=null===e||void 0===e||null===(i=e.valuer)||void 0===i||null===(u=i.image)||void 0===u?void 0:u.location)&&void 0!==t?t:"",name:null!==(m=null===e||void 0===e||null===(g=e.valuer)||void 0===g?void 0:g.name)&&void 0!==m?m:"-"}),(0,S.jsx)("p",{children:r(null===e||void 0===e||null===(y=e.valuer)||void 0===y?void 0:y.name)})]})}),(0,S.jsx)("td",{children:(0,S.jsx)(N.Z,{size:21,image:null===e||void 0===e||null===(k=e.controller)||void 0===k||null===(C=k.image)||void 0===C?void 0:C.location,name:null!==(q=null===e||void 0===e||null===(P=e.controller)||void 0===P?void 0:P.name)&&void 0!==q?q:""})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{className:j()("request-type",{"request-type-color-1":0===(null===e||void 0===e?void 0:e.housing_type),"request-type-color-2":1===(null===e||void 0===e?void 0:e.petition_type)}),children:(null===e||void 0===e?void 0:e.petition_type)>0?r(w[null===e||void 0===e?void 0:e.petition_type]):r(w[0][null===e||void 0===e?void 0:e.housing_type])})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{children:r(null===e||void 0===e||null===(z=e.applicant)||void 0===z?void 0:z.name)})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{children:r(null===e||void 0===e||null===(E=e.owner)||void 0===E?void 0:E.name)})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{children:v(null===e||void 0===e||null===(Z=e.applicant)||void 0===Z?void 0:Z.address)})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{children:r(null===e||void 0===e||null===(L=e.place)||void 0===L?void 0:L.name)})}),(0,S.jsx)("td",{onClick:e=>e.stopPropagation(),children:(0,S.jsxs)(c.Kb,{disabled:2===(null===e||void 0===e?void 0:e.status)||l("update","request","!status"),toggle:s(e),onClick:e=>e.stopPropagation(),isOpen:null===(R=n[null===e||void 0===e?void 0:e._id])||void 0===R?void 0:R.isOpen,children:[(0,S.jsx)(c.Z_,{color:"flat",className:"btn-dropdown",children:(0,S.jsxs)(c.Ct,{className:j()("badge-style",{"badge-style-1":1===(null===e||void 0===e?void 0:e.status),"badge-style-2":2===(null===e||void 0===e?void 0:e.status)||l("update","request","!status")}),children:[(0,S.jsx)("p",{className:"text",children:O[null!==(T=null===e||void 0===e?void 0:e.status)&&void 0!==T?T:0].label}),(0,S.jsx)(f.Z,{size:16})]})}),(0,S.jsx)(c.h_,{children:O.map((l=>l.value!==(null===e||void 0===e?void 0:e.status)&&(0,S.jsx)(c.hP,{tag:"a",onClick:p(e,l.value),children:l.label},l.value)))})]})}),(0,S.jsx)("td",{children:(0,S.jsx)("p",{children:(0,a.Bv)(null===e||void 0===e?void 0:e.createdAt).format("DD/MM/YYYY")})}),(0,S.jsxs)("td",{children:[(0,S.jsxs)("div",{className:"actions-wrapper",children:[(0,S.jsx)(c.zx.Ripple,{color:"flat-secondary",className:"btn-icon rounded-circle",onClick:o(null===e||void 0===e?void 0:e._id,null===e||void 0===e?void 0:e.petition_type),children:(0,S.jsx)(x.Z,{className:"edit-icon",size:16})}),(0,S.jsx)(c.zx.Ripple,{color:"flat-danger",className:"btn-icon rounded-circle",onClick:d(e),children:(0,S.jsx)(b.Z,{size:16})})]}),(null===e||void 0===e?void 0:e.subject)&&(0,S.jsx)(c.vg,{placement:"bottom",target:"tooltip-".concat(null===e||void 0===e?void 0:e._id),children:null===e||void 0===e?void 0:e.subject})]})]},null===e||void 0===e?void 0:e._id)}))})]}),(0,S.jsx)(y.Z,{totalPage:i,handleGetData:u()})]})},C=(0,a.Ev)({ModalSliceActions:s.ModalSlice.actions}),q=(0,n.$j)((e=>{var l,t,i,n,o;let{_authSlice:a,_requestSlice:r}=e;return{filters:null!==(l=null===r||void 0===r?void 0:r.filters)&&void 0!==l?l:{},_id:null!==(t=null===a||void 0===a||null===(i=a.user)||void 0===i?void 0:i._id)&&void 0!==t?t:"",type_shf:null!==(n=null===a||void 0===a||null===(o=a.user)||void 0===o?void 0:o.type_shf)&&void 0!==n?n:""}}),C)((e=>{var l,t,n,a;let{_id:s,filters:d,type_shf:c,modalSliceActions:u}=e;const[v]=(0,r.py)(),p=(0,o.k6)(),[h,g]=(0,i.useState)(1),[j,f]=(0,i.useState)({}),{data:x}=m.b.useGetDataQuery({module:"petitions",params:{page:h,[c?"controller"===c?"id_controller":"id_valuer":void 0]:c&&s,...d}}),[b,{isLoading:y}]=(0,r.F_)({request:null!==(l=null===(t=Object.values(j))||void 0===t?void 0:t[0])&&void 0!==l?l:{}}),_=function(e){return e||(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Sin datos")};return(0,S.jsx)(k,{delegations:{can:v,isLoading:y,dropdownOpen:j,handleEditBtn:(e,l)=>t=>{t.stopPropagation(),p.push("create_request/".concat(e,"?type=").concat(l))},toggleDropdown:e=>l=>{l.stopPropagation();const t=e._id;f((l=>{var i;return{[t]:{...e,isOpen:!(null!==(i=l[t])&&void 0!==i&&i.isOpen)}}}))},getLabelToShow:_,handleDeleteBtn:e=>l=>{l.stopPropagation(),u.openModal({type:"confirmationModal",props:{_id:e._id,identifier:e.key,name:"Solicitud",title:"Eliminar solicitud",confirmationQuestion:"\xbfEst\xe1s seguro de eliminar la solicitud?",bodyText:"No podr\xe1s recuperar la solicitud despu\xe9s de eliminarla.",confirmLabel:"Eliminar",actionToDispatch:"deleteRequest"}})},togglePaginator:()=>e=>g(e),addressFormatter:e=>{if("object"!==typeof e)return"Sin datos";const l="".concat(_(e.street,"*"),", #").concat(_(e.outer_number,"*")," \n\t\t").concat(null!==e&&void 0!==e&&e.inner_number?"- ".concat(e.inner_number):"",",\n\t\t").concat(_(e.colony,"*"),", ").concat(_(e.municipality,"*"));return"*,#*,*,*"===l.replace(/\s/g,"")?"Sin datos":l},handleChangeStatus:b,handleShowRequestDetails:e=>()=>p.push("details_request/".concat(e)),requests:null!==(n=null===x||void 0===x?void 0:x.docs)&&void 0!==n?n:[],totalPage:null!==(a=null===x||void 0===x?void 0:x.totalPages)&&void 0!==a?a:1}})}));var P=t(21720),z=t(12383);const E=[{label:"Linea 2",value:0},{label:"Linea 3",value:1}],Z=[{label:"Capturada",value:0},{label:"Seguimiento",value:1},{label:"Registrada",value:2}],L=[{label:"Vivienda Nueva",value:0},{label:"Vivienda Usada",value:1},{label:"Linea 3",value:2}],R=(0,n.$j)((e=>{var l,t;let{_authSlice:i}=e;return{type_shf:null!==(l=null===i||void 0===i||null===(t=i.user)||void 0===t?void 0:t.type_shf)&&void 0!==l?l:""}}))((e=>{let{type_shf:l,delegations:{date:t,handleSearch:i,handleChangeFilter:n,handleOnClickHeaderBtn:o}}=e;return(0,S.jsxs)("div",{id:"RequestPage",children:[(0,S.jsx)(h.Z,{title:"Solicitudes",btnLabel:"Nueva Solicitud",handleOnclick:o,handleSearch:i,btnOptions:E}),(0,S.jsxs)("div",{className:"filters-container mb-2",children:["valuer"!==l&&(0,S.jsx)(P.Z,{module:"users",name:"valuer",placeholder:"Valuador",query:{typeShf:"valuer"},onChange:e=>n("id_valuer",null===e||void 0===e?void 0:e.value)}),"controller"!==l&&(0,S.jsx)(P.Z,{module:"users",name:"controller",placeholder:"Controlador",query:{typeShf:"controller"},onChange:e=>n("id_controller",null===e||void 0===e?void 0:e.value)}),(0,S.jsx)(z.Z,{name:"status",isClearable:!0,options:Z,placeholder:"Estado",className:"react-select",classNamePrefix:"select",onChange:e=>n("status",null===e||void 0===e?void 0:e.value),menuPortalTarget:document.body}),(0,S.jsx)(z.Z,{name:"petition_type",isClearable:!0,options:L,placeholder:"Tipo de Solicitud",className:"react-select",classNamePrefix:"select",onChange:e=>n("petition_type",null===e||void 0===e?void 0:e.value),menuPortalTarget:document.body}),(0,S.jsxs)("div",{className:"flatpickr-clear-btn",children:[t&&(0,S.jsx)(c.zx,{size:"sm",color:"flat-secondary",className:"btn-icon rounded-circle btn-icon-flatpickr",onClick:()=>n("date",""),children:(0,S.jsx)(u.Z,{size:12})}),(0,S.jsx)(v.Z,{value:t,onChange:e=>{let[l]=e;return n("date",l)},placeholder:"Filtrar por fecha",className:"form-control flatpickr-input intp-flatpick",options:{locale:p.Spanish,dateFormat:"d/m/Y"}})]})]}),(0,S.jsx)(q,{})]})})),T=(0,a.Ev)({GenericSerivices:d.Z,RequestActions:s.RequestSlice.actions}),D=(0,n.$j)((e=>{var l,t;let{_requestSlice:i}=e;return{date:null!==(l=null===i||void 0===i||null===(t=i.filters)||void 0===t?void 0:t.date)&&void 0!==l?l:void 0}}),T)((e=>{let{date:l,requestActions:t}=e;const n=(0,o.k6)(),a=(0,r.Nr)((e=>s("search",e)),700),s=(e,l)=>{const i="date"!==e?l:JSON.parse(JSON.stringify(l));t.setFilters({[e]:i})};return(0,i.useEffect)((()=>()=>{t.clearFilters()}),[]),(0,S.jsx)(R,{delegations:{date:l,handleSearch:a,handleChangeFilter:s,handleOnClickHeaderBtn:e=>()=>n.push("create_request/id?type=".concat(e))}})}))},42506:(e,l,t)=>{t.d(l,{Z:()=>d});var i=t(72791),n=t(52007),o=t.n(n);function a(){return a=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},a.apply(this,arguments)}function r(e,l){if(null==e)return{};var t,i,n=function(e,l){if(null==e)return{};var t,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],l.indexOf(t)>=0||(n[t]=e[t]);return n}(e,l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],l.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=(0,i.forwardRef)((function(e,l){var t=e.color,n=void 0===t?"currentColor":t,o=e.size,s=void 0===o?24:o,d=r(e,["color","size"]);return i.createElement("svg",a({ref:l,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),i.createElement("polyline",{points:"9 18 15 12 9 6"}))}));s.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},s.displayName="ChevronRight";const d=s},72428:(e,l,t)=>{t.d(l,{Z:()=>d});var i=t(72791),n=t(52007),o=t.n(n);function a(){return a=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},a.apply(this,arguments)}function r(e,l){if(null==e)return{};var t,i,n=function(e,l){if(null==e)return{};var t,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],l.indexOf(t)>=0||(n[t]=e[t]);return n}(e,l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],l.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=(0,i.forwardRef)((function(e,l){var t=e.color,n=void 0===t?"currentColor":t,o=e.size,s=void 0===o?24:o,d=r(e,["color","size"]);return i.createElement("svg",a({ref:l,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),i.createElement("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),i.createElement("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}))}));s.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},s.displayName="Edit";const d=s}}]);
//# sourceMappingURL=4852.9ab459b8.chunk.js.map